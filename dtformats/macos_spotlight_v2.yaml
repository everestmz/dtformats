name: macos_spotlight_v2
type: format
description: macOS Spotlight Database v2 file format
urls: []
---
name: byte
type: integer
attributes:
  format: unsigned
  size: 1
  units: bytes
---
name: uint32
type: integer
attributes:
  byte-order: little-endian
  format: unsigned
  size: 4
  units: bytes
---
name: cstring
type: string
encoding: utf8
element_data_type: byte
elements_terminator: "\x00"
---
name: macos_spotlight_v2_file_header
type: structure
members:
- name: signature
  type: stream
  element_data_type: byte
  number_of_elements: 4
- name: flags
  type: stream
  element_data_type: byte
  number_of_elements: 4
- name: zero_gap
  data_type: uint32
- name: unknown_bytes
  type: stream
  element_data_type: uint32
  number_of_elements: 6
- name: header_size
  data_type: uint32
- name: block_0_size
  data_type: uint32
- name: block_size
  data_type: uint32
- name: property_block_location
  data_type: uint32
- name: category_block_location
  data_type: uint32
- name: unknown_block_location
  data_type: uint32
- name: index_1_block_location
  data_type: uint32
- name: index_2_block_location
  data_type: uint32
- name: zero_gap_2
  type: stream
  element_data_type: uint32
  number_of_elements: 64
- name: original_filename
  data_type: cstring
---
name: macos_spotlight_v2_metadata_block_index
type: structure
members:
- name: last_id_in_block
  data_type: uint32
- name: unknown_1
  data_type: uint32
- name: offset_index
  data_type: uint32
- name: unknown_2
  data_type: uint32
---
name: macos_spotlight_v2_block0
type: structure
members:
- name: signature
  type: stream
  element_data_type: byte
  number_of_elements: 4
- name: physical_size
  data_type: uint32
- name: item_count
  data_type: uint32
- name: unknown_1
  data_type: uint32
- name: unknown_2
  data_type: uint32
- name: metadata_block_indexes
  type: sequence
  element_data_type: macos_spotlight_v2_metadata_block_index
  number_of_elements: macos_spotlight_v2_block0.item_count
---
name: macos_spotlight_v2_block_prefix
type: structure
members:
- name: signature
  type: stream
  element_data_type: byte
  number_of_elements: 4
- name: physical_size
  data_type: uint32
- name: logical_size
  data_type: uint32
- name: block_type
  data_type: uint32
- name: unknown_1
  data_type: uint32
- name: next_block
  data_type: uint32
- name: unknown_2
  data_type: uint32
- name: unknown_3
  data_type: uint32
---
name: macos_spotlight_v2_category_entry
type: structure
members:
- name: index
  data_type: uint32
- name: value
  data_type: cstring
---
name: macos_spotlight_v2_property_entry
type: structure
members:
- name: index
  data_type: uint32
- name: value_type
  data_type: byte
- name: property_type
  data_type: byte
- name: value
  data_type: cstring
---
name: macos_spotlight_v2_index_entry
type: structure
members:
- name: index
  data_type: uint32
---
name: macos_spotlight_v2_metadata_block
type: structure
members:
- name: signature
  type: stream
  element_data_type: byte
  number_of_elements: 4
- name: physical_size
  data_type: uint32
- name: logical_size
  data_type: uint32
- name: block_type
  data_type: uint32
- name: unknown_1
  data_type: uint32
- name: compressed_data
  type: stream
  element_data_type: byte
  number_of_elements: macos_spotlight_v2_metadata_block.logical_size
---
name: macos_spotlight_v2_metadata_item
type: structure
members:
  - name: size
    data_type: uint32
  - name: data
    type: stream
    element_data_type: byte
    number_of_elements: macos_spotlight_v2_metadata_item.size
